<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Mech Commander 2 HD  | Blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.72.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/mc2-website/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    
      <link href="%7balternate%20%7bRSS%20application/rss&#43;xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/mc2-website/blog/index.xml%20https://alariq.github.io/mc2-website/blog/index.xml%7d" rel="alternate" type="application/rss+xml" title="Mech Commander 2 HD" />
      <link href="%7balternate%20%7bRSS%20application/rss&#43;xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/mc2-website/blog/index.xml%20https://alariq.github.io/mc2-website/blog/index.xml%7d" rel="feed" type="application/rss+xml" title="Mech Commander 2 HD" />
    

    <meta property="og:title" content="Blog" />
<meta property="og:description" content="A simple linux port and engine rewrite to OpenGL" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://alariq.github.io/mc2-website/blog/" />
<meta property="og:updated_time" content="2017-03-02T12:00:00-05:00" />
<meta itemprop="name" content="Blog">
<meta itemprop="description" content="A simple linux port and engine rewrite to OpenGL"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Blog"/>
<meta name="twitter:description" content="A simple linux port and engine rewrite to OpenGL"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    

  
  
  <header class="cover bg-top" style="background-image: url('https://alariq.github.io/mc2-website/images/title.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://alariq.github.io/mc2-website/" class="f3 fw2 hover-white no-underline white-90 dib">
      Mech Commander 2 HD
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/mc2-website/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/mc2-website/blog/" title="DevBlog page">
              DevBlog
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/mc2-website/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/mc2-website/download/" title="Downloads page">
              Downloads
            </a>
          </li>
          
        </ul>
      
      







<a href="https://github.com/alariq/mc2" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>





    </div>
  </div>
</nav>

      <div class="tc-l pv4 pv6-l ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
          Blog
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      

  <article class="pa3 pa4-ns nested-copy-line-height nested-img">
    <section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray">
      <p>This is pretty much a dump of what I&rsquo;ve been working on during making this port. It also contains some dev screenshots.</p>

    </section>
    
    
    <aside class="flex flex-column items-center justify-around mt5 ">
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        December 1, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day53/" class="link black dim">
        Day 53 &#43; image of the day
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>fixed a problem with texture that had <code>id = 0</code> not being applied :-)
it was a font texture (used at least for in-game text), so some text was not visible due to this reason</p>
<p>Image of the day: <a href="/images/devblog/day53_2016-12-01-145456_1920x1080_scrot.png"><figure>
    <img src="/images/devblog/day53_2016-12-01-145456_1920x1080_scrot.png"
         alt="click to expand"/> 
</figure>
</a></p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 29, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day51/" class="link black dim">
        Day 51
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>was changing <code>long</code> to <code>int32_t</code> in <code>ABL</code> related files&hellip; well <code>extern</code>s are evil!
consider:</p>
<p>1.cpp</p>
<pre><code>int myVar;
</code></pre><p>2.cpp</p>
<pre><code>extern long myVar;
</code></pre><p>good luck looking for a bug&hellip;</p>
<p>ABL uses lots of them!!!</p>
<p>even if you think you&rsquo;ve correclty changed all longs to ints, there is such code as:</p>
<pre><code>long my_stack_var;
memcpy(myVar, my_stack_var, sizeof(long)); // well this you may catch by searching for &quot;long&quot;
// but consider this
memcpy(myVar, my_stack_var, sizeof(my_stack_var));// :O
</code></pre><p>I hope I did not leave such cases&hellip;.</p>
<p>Also was changing(long -&gt; int) in all structures that are saved in order to surpport saves from 32bit systems</p>
<p>Finally, fixed nasty bug when repair truck sometimes was not appearing. As I see, it is uninitialized variable <code>isOnGui</code> which prevented it from being drawn</p>
<p>when it happened that it was false, repair truck tried to be drawn as alpha transparent oject, but in fact was not drawn because there was no branch that was drawing objects with just <code>MC2_DRAWALPHA</code> flag set.
(see comments in commit for more explanation)</p>
<p>Look like Windows version always initializes memory with <code>0xff</code> an so they did not have such a problem. Should I do the same? :-) just to repeat all their issues :-)</p>
<p>no I&rsquo;ll expose all of them and fix them&hellip; maybe :-)</p>
<p>Ok, will have a cup of tea and go to sleep, after all I have a birthday tomorrow!
(that is because I am writing it on 28 though this blog records is for day earlier)</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 29, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day52/" class="link black dim">
        Day 52
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>fixed memory leak in <code>gosAudio_CreateResource</code></p>
<p>in training mission 5 <code>&quot;terminationResult&quot;</code> variable was screwed (see mission.cpp 667 - 676 lines)</p>
<p>apparently guys had a strange sense of humor and added playing of win/lose tunes if <code>terminationResult</code> was not as one might expect to find out ABL issues, and apparently training mission 5 has them.</p>
<p>I do not know if it had them before, or they we caused by my recent changes in <code>abl</code> code (<code>long-&gt;int</code>), I hope not. Will have to check tough</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 26, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day50/" class="link black dim">
        Day 50
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>finished initial draft sound implementation, there are some <code>wav</code> files which cannot be loaded neither by <code>SDL</code> nor by <code>SDL_mixer</code>,
also noise sounds that repacked have to be extracted.</p>
<p>made couple of small fixes like avoiding triggering assert() when dividing by a very small number, happened because currently frame time is faked by me as 16msec :-), and others</p>
<p>even finished E3 mission :-) from .. maybe 10th try, because of anoying asserts and PAUSE()/STOP() triggerings.
some strange issue still remains with trying to render text which is NULL</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 25, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day49/" class="link black dim">
        Day 49
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>proceeded with sound, almost can play game with all sounds available, though still lack a lot of sound support stuff and resource loading could be smarter.</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 23, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day48/" class="link black dim">
        Day 48
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>started to add sound support. looks like signed to unsinged conversion fails to work but mono/stereo and frequency conversion works, hmmm</p>
<p>no screenshots in near future, I expect :-)</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 19, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day47/" class="link black dim">
        Day 47
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>added conversion between <code>rgba -&gt; bgra -&gt; rgba</code> when locking and unlocking, because CPU code expects textures in BGRA, so I have correct colors now</p>
<p>also fixed very interesting issue.</p>
<p>fors code was like this:</p>
<pre><code>unsigned long s_textureHandle[] = {-1, -1, -1, -1};
</code></pre><p>clang was complaining that there is conversion or something like this, so I changed this to:</p>
<pre><code>unsigned long s_textureHandle[] = {-1u, -1u, -1u, -1u};
</code></pre><p>and then today I&rsquo;ve got a crash because of this conditional:</p>
<pre><code>if(s_textureHandle[i] == -1) {
}
</code></pre><p>It was giving <code>false</code>, what happened in this case is:</p>
<ol>
<li><code>-1u</code> got converted into <code>0xffffffff</code>, and promoted to <code>long</code>.</li>
<li>inside condition expression: -1 got promoted to <code>unsigned long</code> with sign extension, so first: it became -1 long, and then converted to unsigned 0xffffffffffffffff, and suddenly it all broke</li>
</ol>
<p>before it worked, of course. because in construction of <code>s_textureHandle[]</code> -1 got converted to <code>0xffffffffffffffff</code> as well.</p>
<p>phew, I have to be more carefull with those <code>longs</code></p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 19, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day46/" class="link black dim">
        Day 46
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>trying to figure out why some textures do not have nice blue background&hellip;. :-/ like ones in solo mission on single player option map.</p>
<p>but in-game minimap has this nice background and windows version also has it</p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 14, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day45/" class="link black dim">
        Day 45 &#43; image of the day
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>implemented proper (well.. I mean, it works sometimes) texutre lock/unlock</p>
<p>figured out why mouse cursor is not drawn sometimes (mc2 mouse is processed in a separate thread. Something like <code>this</code> variable was set or not set depending on some strange reasons)</p>
<p>we shoulld always assume it is not in a separate thread and that is it!</p>
<p>spent whole evening tracking strange issue when mechs would not go where I told them&hellip; but would do it if I said to shoot, apparently I had 2 errors in <code>timeGetTime()</code></p>
<p>and overall I was wrong by <code>1e3</code> in 2 places :-), thanks gdb and watchpoints, now camera also works better and I even finished a mission, though, it crashed on a mission end screen :-)</p>
<p>so, quite a productive evening today.
thank you all :P
bye!</p>
<p>Image of the day: <a href="/images/devblog/day45_2016-11-14-015725_3841x1201_scrot.png"><figure>
    <img src="/images/devblog/day45_2016-11-14-015725_3841x1201_scrot.png"
         alt="click to expand"/> 
</figure>
</a></p>

    </div>
  </div>

        </div>
      
        
        <div class="relative w-60-l w-90-ns mb4 bg-white">
          
            <div class="mb3 pa4 mid-gray overflow-hidden">
    
      <div class="f6">
        November 12, 2016
      </div>
    
    <h1 class="f3 near-black">
      <a href="/mc2-website/blog/day44/" class="link black dim">
        Day 44 &#43; image of the day
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>continue with various fixes.</p>
<p>one that was quite scary is memery block filling with NANs. when first memory was cast to <code>long*</code> but number of iterations was divided only by 4, ..who cares about 64bit <code>long</code> in 2001</p>
<p>finally I can play a game now! though mech would not move where I tell them, only start moving and then stop again.
It is interesting, that they move if they need to come closer to shoot (when I aim cursor at the target and click)</p>
<p>Image of the day: <a href="/images/devblog/day44_2016-11-12-183952_3841x1201_scrot.png"><figure>
    <img src="/images/devblog/day44_2016-11-12-183952_3841x1201_scrot.png"
         alt="click to expand"/> 
</figure>
</a></p>

    </div>
  </div>

        </div>
      
    </aside>
    <div align="center">
    

<ul class="pagination">
    
    <li class="page-item">
        <a href="/mc2-website/blog/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/mc2-website/blog/page/3/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/mc2-website/blog/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/mc2-website/blog/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/mc2-website/blog/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/mc2-website/blog/page/4/">4</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/mc2-website/blog/page/5/">5</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/mc2-website/blog/page/9/">9</a></li>
    
    
    <li class="page-item">
    <a href="/mc2-website/blog/page/5/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/mc2-website/blog/page/9/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


    </div>
  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://alariq.github.io/mc2-website/" >
    &copy; 2020 Mech Commander 2 HD
  </a>
    <div>







<a href="https://github.com/alariq/mc2" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>




</div>
  </div>
</footer>

    

  <script src="/mc2-website/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
